from sqlalchemy import Column, String, create_engine,Integer
from sqlalchemy.orm import sessionmaker
from sqlalchemy.ext.declarative import declarative_base
# 创建对象的基类:
Base = declarative_base()
# 定义User对象:
import pymysql
class Medicine(Base):
    # 表的名字:
    __tablename__ = 'spider_qualification'

    # 表的结构:
    id = Column(Integer(), primary_key=True,autoincrement=True)
    company_name = Column(String(256))
    license_num = Column(String(256))
    license_name = Column(String(256))
    project_name = Column(String(256))
    valid_date = Column(String(256))
    invalid_date = Column(String(256))

# 初始化数据库连接:
engine = create_engine('mysql+pymysql://root:BOOT-xwork1024@192.168.2.97:3306/spider')
# 创建DBSession类型:
DBSession = sessionmaker(bind=engine)
# 创建session对象:
session = DBSession()

# ICP 类 的 580
def main():
    # 针对ICP EDI类型的数据
    # 根据公司名+证书类型进行筛选重复数据的，因为同一证书号，可能有多个证书类型
    # data = session.query(Medicine).filter(Medicine.id < 100000)
    # flag = []
    # single = {}
    # sum = []
    # for d in data:
    #     id = d.id
    #     # if id < 100000:
    #     #     continue
    #     # if id > 100000:
    #     #     break
    #     project_name = d.project_name
    #     if project_name == '码号':
    #         continue
    #     company_name = d.company_name
    #     license_name = ''.join(d.license_name)
    #
    #     if company_name in flag:
    #         licenses = single[company_name]
    #         if license_name in licenses:
    #             if license_name != '[]':
    #                 print(id,company_name,license_name)
    #                 medi = session.query(Medicine).filter(Medicine.id == id).first()
    #                 session.delete(medi)
    #                 sum.append(id)
    #                 continue
    #         else:
    #             single[company_name] = licenses + license_name
    #     else:
    #         flag.append(company_name)
    #         single[company_name] = ''.join(license_name)
    # # session.commit()
    # print(len(sum))

    # 针对食品许可证类型的数据
    data = session.query(Medicine).filter(Medicine.id > 100000)
    flag = []
    single = {}
    sum = []
    for d in data:
        try:
            id = d.id
            company_name = d.company_name
            license_num = d.license_num
            valid_date = ''.join(d.valid_date)

            if license_num in flag:
                licenses = single[license_num]
                if valid_date in licenses:
                    print(id,company_name,license_num,valid_date)
                    sum.append(id)
                    continue

            else:
                flag.append(license_num)
                print('1')
                single[license_num] = ''.join(valid_date)
        except Exception:
            continue
    print(len(sum))
def delete():
    # 删除重复的数据 ： 2598
    delate_data = [104728, 108928, 109078, 109128, 109178, 109378, 109628, 109678, 109679, 109728, 110978, 111028, 111029, 111030, 111031, 111032, 111033, 111034, 111035, 111036, 111037, 111038, 111039, 111040, 111041, 111042, 111078, 111079, 111080, 111081, 111082, 111083, 111728, 112478, 112778, 113528, 114278, 114378, 114428, 114478, 114578, 114728, 114828, 114829, 114830, 114831, 114832, 115078, 115228, 115378, 115379, 115478, 115528, 115529, 115578, 116528, 117878, 119228, 120328, 120428, 120478, 120678, 120878, 120879, 121178, 121228, 121278, 121279, 121378, 121528, 121628, 121778, 122128, 122228, 122229, 122328, 122728, 122928, 123028, 123378, 123728, 123729, 124128, 124728, 124828, 124829, 124878, 124928, 124978, 125028, 125029, 125078, 125079, 125128, 125178, 125228, 125229, 125278, 125279, 125328, 125378, 125379, 125380, 125381, 125628, 126178, 126179, 126228, 126278, 126279, 126280, 126378, 126379, 126528, 127228, 127728, 128278, 128378, 128628, 128778, 128978, 128979, 129078, 129228, 129328, 130178, 130828, 131328, 131678, 132228, 132478, 132628, 133128, 133129, 133178, 133328, 133378, 133428, 133578, 133628, 133678, 134078, 134178, 134328, 134378, 134478, 134778, 134828, 134878, 134928, 135528, 136178, 136528, 136628, 136728, 136878, 136879, 136978, 137228, 138228, 138628, 139228, 140678, 141528, 142378, 143678, 147478, 147628, 148228, 148328, 148428, 148528, 148678, 148778, 148878, 148978, 149078, 149228, 149328, 149329, 152528, 156091, 186114, 193396, 262277, 262603, 265675, 267196, 270900, 276241, 278400, 278417, 280360, 283307, 288149, 292695, 293128, 293129, 293140, 293488, 293489, 293491, 293501, 293826, 293828, 293829, 294155, 294596, 298948, 300155, 300175, 302048, 302400, 302717, 303509, 303939, 305281, 305288, 309965, 313811, 324783, 325065, 325439, 329275, 333631, 334423, 342666, 342923, 344199, 344200, 345279, 347466, 348789, 349412, 349650, 349651, 350304, 350532, 352673, 353232, 353557, 354145, 354550, 355306, 355393, 355791, 356182, 356930, 358114, 358401, 358778, 360002, 362424, 362432, 362480, 362481, 362482, 363476, 365152, 365485, 365486, 365487, 365489, 365739, 365740, 366042, 366579, 366580, 366581, 366582, 366583, 367048, 367385, 367615, 368204, 368523, 368532, 368764, 368862, 369406, 369407, 369649, 369679, 371003, 371006, 371007, 371258, 371821, 372092, 372558, 373485, 373488, 374313, 374638, 374883, 375267, 375317, 375320, 375322, 375841, 376325, 376451, 376588, 376631, 378010, 378837, 378902, 379610, 379681, 379853, 379855, 380301, 380302, 380303, 380522, 380866, 381547, 382026, 382219, 382229, 382830, 382831, 382834, 383087, 383091, 383096, 383161, 383948, 384716, 384717, 384719, 384722, 384953, 384955, 384956, 384957, 384958, 384960, 385278, 385280, 385282, 385283, 385284, 385288, 385289, 385540, 385640, 385641, 385643, 385648, 385650, 385651, 385652, 385654, 385655, 385660, 385661, 385662, 385663, 385667, 385668, 385669, 385670, 385671, 385672, 385674, 385964, 386218, 386282, 386605, 386888, 386889, 387102, 387107, 387210, 387211, 387212, 387213, 387578, 387579, 387582, 387585, 387586, 387587, 387592, 387952, 387954, 387956, 388228, 388403, 388504, 388507, 388509, 388510, 388511, 388512, 388516, 388518, 388519, 388520, 388522, 388758, 389142, 389559, 389561, 389849, 390087, 390622, 390623, 390628, 391203, 391204, 391205, 391212, 391213, 391214, 391938, 392221, 392538, 392539, 392540, 392541, 392542, 392882, 392883, 392884, 392885, 392886, 393138, 393139, 393140, 393141, 393142, 393146, 393147, 393452, 393453, 393457, 393458, 393462, 393464, 393833, 393837, 393838, 394382, 394385, 394644, 394645, 394646, 394647, 395248, 395528, 395603, 395606, 395937, 396099, 396171, 396172, 396173, 396174, 396176, 396178, 396181, 396520, 396722, 396737, 396805, 396807, 396808, 396811, 396813, 396814, 396815, 396819, 397120, 397121, 397123, 397125, 397126, 397127, 397128, 397461, 397821, 397822, 397823, 398339, 398406, 398408, 398646, 398648, 398940, 398944, 398946, 399572, 399874, 399882, 399885, 400211, 400213, 400214, 400219, 400221, 400223, 400226, 400227, 400228, 400234, 400528, 400529, 400530, 400532, 400533, 400534, 400535, 400845, 400849, 400851, 400852, 401133, 401135, 401136, 401139, 401144, 401145, 401576, 401579, 401580, 401582, 401584, 401585, 401890, 401891, 401894, 402280, 402282, 402283, 402284, 402285, 402287, 402288, 402289, 402296, 402297, 402302, 402304, 402305, 402309, 402319, 402882, 402883, 403141, 403441, 403442, 403444, 403445, 403450, 403648, 403654, 403725, 403728, 403729, 403730, 403731, 404108, 404111, 404113, 404376, 404379, 404380, 404381, 404382, 404383, 404703, 404705, 405066, 405069, 405074, 405075, 405080, 405084, 405355, 405358, 405359, 405364, 405612, 405972, 405973, 405974, 405975, 405978, 405979, 406279, 406285, 406286, 406287, 406465, 406528, 406529, 406530, 406531, 406532, 406533, 406811, 406812, 406813, 406817, 406818, 406823, 406824, 406825, 406831, 406834, 407100, 407104, 407106, 407108, 407426, 407428, 407429, 407430, 407431, 407618, 407627, 407912, 407915, 407916, 408207, 408210, 408214, 408216, 408217, 408218, 408224, 408225, 408827, 408828, 408834, 408838, 408841, 409077, 409081, 409088, 409579, 409584, 409594, 409595, 409751, 409777, 409779, 409782, 410026, 410031, 410033, 410359, 410363, 410604, 410769, 410773, 410807, 410809, 410988, 411291, 411294, 411295, 411296, 411297, 411639, 411640, 411641, 411646, 411647, 411652, 411658, 412219, 412222, 412223, 412433, 412655, 412657, 412658, 412661, 412894, 413135, 413140, 413410, 413506, 413514, 413646, 413713, 413714, 413715, 413927, 413929, 413930, 413932, 413938, 413939, 413940, 414138, 414142, 414147, 414179, 414185, 414192, 414197, 414198, 414337, 414379, 414381, 414383, 415101, 415104, 415331, 415333, 415337, 415340, 415341, 415758, 415761, 415762, 416657, 416829, 416832, 417226, 417665, 417667, 418037, 418982, 419898, 420006, 420426, 420609, 421130, 421520, 421521, 421754, 421763, 421764, 421765, 421919, 422170, 422173, 422352, 422970, 423134, 423334, 423347, 423695, 423882, 424299, 425311, 425314, 425317, 425737, 425738, 425956, 426118, 426279, 426286, 426679, 427032, 427212, 427374, 427709, 427714, 427887, 427893, 427915, 428059, 428473, 428474, 428478, 428870, 428882, 428886, 429027, 429681, 429881, 429882, 430849, 431173, 431179, 431508, 431509, 431822, 431958, 432255, 432260, 432989, 433139, 433142, 433683, 433944, 434617, 435631, 435976, 435981, 436426, 436795, 437619, 437620, 437621, 437788, 437789, 437790, 437984, 438657, 438671, 438929, 438938, 439432, 439834, 439835, 440159, 441017, 441018, 441019, 442328, 442329, 442829, 442830, 442831, 442834, 443323, 443505, 443703, 443946, 444293, 444540, 444794, 444915, 445267, 445462, 445463, 445464, 445684, 446435, 446665, 446666, 446668, 447113, 447114, 447882, 447904, 447906, 448267, 448273, 448275, 448277, 448940, 449826, 450751, 451387, 451823, 452291, 452489, 453142, 453449, 453800, 453805, 453809, 454049, 454050, 454053, 454280, 455818, 455819, 456386, 457070, 457071, 457777, 458035, 458813, 458845, 458846, 458847, 458848, 459210, 459432, 459745, 460166, 460167, 460872, 460874, 460875, 460997, 461030, 464422, 467089, 467328, 467791, 469599, 470289, 470979, 471855, 471856, 471946, 473080, 473403, 473408, 473416, 473433, 473814, 474100, 474103, 474179, 474253, 474254, 474255, 474256, 474257, 474258, 474259, 474260, 474261, 474262, 474263, 474264, 474265, 474266, 474267, 474268, 474269, 474270, 474272, 474273, 474326, 474327, 474328, 474332, 474333, 474337, 474338, 474342, 474453, 474455, 474456, 474457, 474458, 474459, 474460, 474462, 474463, 474465, 474466, 474467, 474468, 474469, 474471, 474472, 474473, 474474, 474475, 474476, 474477, 474478, 474479, 474480, 474563, 474564, 474568, 474570, 474572, 474573, 474574, 474575, 474576, 474578, 474580, 474582, 474585, 474593, 474605, 474610, 474617, 474698, 474699, 474701, 474702, 474703, 474704, 474705, 474706, 474707, 474708, 474709, 474710, 474711, 474712, 474713, 474714, 474715, 474716, 474760, 474761, 474762, 474833, 474835, 474837, 474839, 474840, 474842, 474843, 474844, 474857, 474858, 474860, 474863, 474876, 474987, 474990, 474991, 474992, 474993, 474995, 474996, 474997, 474998, 474999, 475000, 475002, 475003, 475004, 475005, 475007, 475008, 475009, 475010, 475011, 475012, 475013, 475014, 475015, 475018, 475019, 475020, 475022, 475023, 475024, 475025, 475026, 475027, 475028, 475029, 475030, 475031, 475110, 475112, 475113, 475115, 475116, 475117, 475118, 475120, 475121, 475122, 475123, 475124, 475125, 475129, 475130, 475132, 475133, 475134, 475135, 475136, 475137, 475138, 475139, 475140, 475141, 475142, 475143, 475241, 475242, 475243, 475248, 475251, 475255, 475256, 475263, 475264, 475267, 475268, 475338, 475339, 475341, 475342, 475344, 475362, 475366, 475375, 475464, 475465, 475466, 475468, 475470, 475472, 475473, 475474, 475475, 475476, 475477, 475478, 475479, 475480, 475481, 475482, 475483, 475484, 475485, 475486, 475487, 475488, 475489, 475490, 475492, 475493, 475494, 475495, 475496, 475573, 475575, 475577, 475578, 475580, 475581, 475584, 475585, 475586, 475587, 475588, 475590, 475591, 475592, 475646, 475648, 475649, 475650, 475651, 475652, 475653, 475654, 475657, 475658, 475659, 475661, 475662, 475663, 475665, 475666, 475667, 475668, 475669, 475670, 475671, 475752, 475755, 475757, 475758, 475759, 475760, 475761, 475763, 475765, 475767, 475853, 475854, 475857, 475939, 475940, 475942, 475943, 475947, 475948, 475949, 475950, 475951, 475952, 475953, 475954, 475955, 475956, 475957, 475958, 475959, 475963, 476042, 476046, 476059, 476074, 476148, 476149, 476150, 476151, 476152, 476153, 476154, 476155, 476156, 476157, 476158, 476159, 476160, 476161, 476163, 476164, 476165, 476166, 476167, 476168, 476169, 476170, 476171, 476172, 476231, 476240, 476334, 476338, 476342, 476345, 476349, 476358, 476363, 476366, 476430, 476433, 476435, 476436, 476438, 476440, 476441, 476442, 476447, 476448, 476507, 476508, 476511, 476521, 476598, 476599, 476654, 476656, 476657, 476658, 476663, 476735, 476737, 476783, 476785, 476786, 476790, 476794, 476797, 476831, 476872, 476939, 476943, 476944, 476945, 476946, 476948, 476953, 476956, 477015, 477025, 477359, 477497, 477624, 477904, 477933, 477976, 478191, 478199, 478213, 478555, 478825, 478913, 479202, 479849, 482195, 484048, 486288, 487455, 492505, 493285, 493708, 493808, 494085, 494418, 495610, 496213, 496215, 496216, 496220, 496221, 496222, 496223, 496224, 496225, 496227, 496228, 496229, 496230, 496231, 496232, 496233, 496234, 496235, 496236, 496237, 496239, 496240, 496242, 496244, 496273, 496276, 496279, 496281, 496407, 496408, 496409, 496410, 496413, 496414, 496415, 496416, 496419, 496425, 496426, 496431, 496432, 496433, 496434, 496435, 496437, 496438, 496439, 496440, 496442, 496445, 496447, 496449, 496450, 496451, 496454, 496455, 496456, 496457, 496458, 496459, 496460, 496461, 496462, 496463, 496464, 496465, 496466, 496467, 496469, 496471, 496472, 496474, 496475, 496477, 496478, 496479, 496535, 496537, 496592, 496596, 496672, 496675, 496811, 496815, 496820, 496827, 496832, 496835, 497050, 497053, 497090, 497185, 497187, 497188, 497203, 497207, 497208, 497231, 497415, 497489, 497490, 497587, 497710, 497715, 497718, 497841, 497843, 497850, 498135, 498139, 498251, 498254, 498258, 498412, 504548, 504575, 504582, 504636, 504647, 504660, 504673, 504679, 504681, 504758, 504773, 504789, 504802, 504803, 504885, 504889, 506234, 512205, 515478, 515479, 516786, 516787, 516788, 518969, 518970, 524739, 524741, 526997, 526998, 527004, 528913, 528914, 528918, 571020, 571186, 571196, 571206, 571373, 571380, 571390, 571397, 571408, 571412, 571422, 571424, 571437, 571443, 571444, 571466, 571477, 571803, 571838, 571840, 571857, 571861, 571886, 571959, 572213, 572215, 572252, 572256, 572257, 572275, 572302, 572317, 572539, 572623, 572633, 572634, 575834, 575839, 575840, 575841, 575877, 575881, 576588, 576589, 576596, 576599, 576606, 576610, 576620, 577616, 577626, 577627, 577628, 578219, 578291, 580836, 580984, 582331, 584174, 584424, 584514, 584817, 584819, 585643, 586072, 586127, 586128, 586445, 586712, 587493, 588061, 588073, 588277, 588282, 588397, 588543, 588595, 588671, 588676, 588875, 589124, 589389, 589413, 589426, 589635, 590264, 590654, 591072, 591142, 591161, 591166, 591179, 591186, 591208, 591221, 591385, 591567, 591568, 591598, 592008, 592027, 592070, 592113, 592217, 592253, 592330, 592507, 592511, 592517, 592558, 592577, 592615, 592813, 592845, 592858, 592902, 592904, 592905, 592918, 592990, 593091, 593187, 593218, 593278, 593507, 593543, 593546, 593610, 594257, 594339, 594395, 595164, 595165, 595337, 595340, 595349, 595449, 595499, 595512, 595516, 595579, 595792, 595835, 595875, 595963, 595964, 596274, 596318, 596324, 596396, 596401, 596403, 596441, 596788, 596815, 596928, 596978, 597119, 597158, 597521, 597522, 598093, 598096, 598126, 598130, 598131, 598164, 598295, 598296, 598298, 598368, 598400, 598411, 598413, 598441, 598442, 598443, 598506, 598525, 598581, 598630, 598676, 598758, 598800, 598871, 598885, 598932, 598941, 598976, 598977, 598984, 599087, 599197, 599198, 599200, 599229, 599232, 599234, 599264, 599269, 599270, 599391, 599392, 599404, 599453, 599456, 599458, 599459, 599534, 599535, 599536, 599633, 599635, 599757, 599778, 599779, 599781, 599782, 599795, 599800, 599861, 599862, 599863, 599879, 599896, 599899, 599950, 599952, 599953, 599982, 599985, 599986, 599987, 599989, 600038, 600039, 600062, 600155, 600156, 600157, 600244, 600246, 600266, 600367, 600370, 600372, 600373, 600477, 600541, 600579, 600609, 600612, 600613, 600664, 600665, 600666, 600694, 600695, 600718, 600721, 600723, 600762, 600796, 600797, 600798, 600799, 600800, 600833, 600834, 600845, 600846, 600847, 600848, 600850, 600901, 600902, 600905, 600911, 600913, 600928, 600940, 600943, 600944, 600973, 600976, 601006, 601007, 601010, 601073, 601075, 601114, 601117, 601146, 601149, 601151, 601261, 601302, 601305, 601306, 601351, 601433, 601442, 601443, 601444, 601445, 601470, 601471, 601482, 601503, 601554, 601556, 601604, 601637, 601654, 601655, 601656, 601660, 601661, 601670, 601672, 601685, 601686, 601703, 601704, 601705, 601734, 601735, 601770, 601800, 601802, 601814, 601816, 601837, 601838, 601839, 601852, 601878, 601900, 601902, 601972, 601973, 601997, 601999, 602010, 602037, 602078, 602108, 602183, 602184, 602268, 602289, 602296, 602300, 602413, 602485, 602489, 602524, 602689, 602716, 602751, 602752, 602754, 602781, 602829, 602908, 602915, 602933, 602937, 602951, 602952, 602954, 603017, 603018, 603021, 603069, 603080, 603081, 603082, 603084, 603107, 603109, 603110, 603131, 603178, 603221, 603235, 603255, 603283, 603285, 603333, 603362, 603388, 603413, 603462, 603463, 603475, 603553, 603555, 603557, 603558, 603566, 603590, 603606, 603607, 603685, 603703, 603727, 603793, 603809, 603824, 603825, 603845, 603863, 603872, 603925, 603928, 603929, 603981, 603983, 604018, 604021, 604022, 604043, 604078, 604099, 604124, 604125, 604127, 604156, 604158, 604159, 604216, 604219, 604231, 604277, 604291, 604292, 604333, 604334, 604361, 604362, 604372, 604373, 604400, 604402, 604410, 604412, 604413, 604433, 604448, 604449, 604450, 604470, 604489, 604512, 604527, 604534, 604554, 604566, 604568, 604569, 604571, 604603, 604609, 604712, 604718, 604722, 604723, 604756, 604825, 604842, 604895, 604897, 604907, 604918, 604947, 605008, 605025, 605058, 605064, 605086, 605097, 605173, 605176, 605184, 605191, 605206, 605212, 605216, 605280, 605306, 605309, 605454, 605516, 605569, 605572, 605594, 605612, 605685, 605766, 605767, 605938, 605972, 606022, 606037, 606101, 606148, 606194, 606214, 606234, 606242, 606243, 606277, 606327, 606436, 606521, 606546, 606565, 606590, 606615, 606638, 606639, 606647, 606703, 606725, 606746, 606759, 606776, 606827, 606908, 606922, 606944, 606950, 606991, 606999, 607030, 607059, 607079, 607082, 607085, 607093, 607097, 607099, 607145, 607149, 607200, 607204, 607302, 607303, 607359, 607415, 607463, 607487, 607512, 607596, 607670, 607766, 607864, 607949, 607950, 607959, 607976, 608161, 608206, 608331, 608343, 608373, 608374, 608376, 608430, 608447, 608470, 608485, 608654, 608666, 608691, 608692, 608694, 608695, 608755, 608967, 609106, 609130, 609133, 609175, 609241, 609269, 609287, 609317, 609423, 609428, 609518, 609538, 609563, 609577, 609625, 609626, 609660, 609722, 609741, 609755, 609766, 609910, 609936, 610019, 610065, 610076, 610140, 610147, 610220, 610235, 610251, 610252, 610304, 610313, 610368, 610411, 610412, 610425, 610426, 610491, 610492, 610539, 610541, 610617, 610672, 610673, 610674, 610675, 610676, 610685, 610696, 610789, 610831, 610834, 610846, 610859, 610860, 610981, 611015, 611072, 611153, 611257, 611278, 611332, 611358, 611504, 611507, 611551, 611558, 611647, 611650, 611716, 611717, 611721, 611832, 611841, 611857, 611861, 611898, 611907, 611960, 611984, 612124, 612130, 612167, 612397, 615423, 617059, 618080, 618415, 619961, 619974, 620340, 620747, 620768, 620792, 620796, 621133, 621352, 621907, 621975, 622058, 622060, 622280, 622624, 622640, 622718, 622722, 622772, 622801, 622896, 622897, 622900, 622947, 622959, 623061, 623065, 623574, 623674, 623709, 623776, 623812, 623834, 623860, 624606, 625105, 625330, 625353, 625366, 625389, 625599, 625781, 625793, 625806, 625967, 626315, 626533, 627059, 627290, 627969, 628225, 628360, 628410, 628591, 628785, 629139, 629225, 629395, 629432, 629666, 629703, 629766, 629878, 630288, 630300, 630689, 630750, 630924, 630962, 631024, 631162, 631868, 631880, 632305, 632381, 632531, 632554, 632946, 633170, 633283, 633433, 633618, 633678, 633739, 634119, 634353, 634366, 634499, 634589, 634630, 634747, 634814, 634866, 634895, 634941, 634949, 634996, 635047, 635138, 635143, 635206, 635213, 635222, 635235, 635242, 635250, 635252, 635254, 635255, 635266, 635287, 635300, 635302, 635310, 635352, 635369, 635436, 635438, 635459, 635477, 635492, 635495, 635504, 635523, 635547, 635589, 635636, 635647, 635728, 635745, 635783, 635811, 635860, 635951, 636006, 636049, 636146, 636173, 636178, 636187, 636192, 636298, 636426, 636557, 636724, 636787, 636790, 636845, 636852, 636858, 636904, 636920, 637035, 637052, 637064, 637077, 637109, 637120, 637227, 637228, 637277, 637346, 637387, 637417, 637436, 637441, 637470, 637475, 637511, 637531, 637580, 637612, 637649, 637698, 637715, 637741, 637854, 637897, 637904, 637943, 637952, 637957, 637960, 637962, 638022, 638023, 638097, 638101, 638106, 638130, 638143, 638196, 638223, 638224, 638234, 638297, 638299, 638498, 638527, 638661, 638680, 638690, 638702, 638767, 638770, 638772, 638775, 638783, 638786, 638879, 638889, 638986, 638990, 639012, 639030, 639046, 639093, 639135, 639141, 639155, 639211, 639224, 639242, 639256, 639270, 639286, 639303, 639310, 639326, 639328, 639339, 639367, 639375, 639378, 639380, 639429, 639458, 639589, 639666, 643468, 643483, 643528, 644455, 645252, 647468, 647484, 647494, 647590, 648237, 648325, 648340, 650183, 653860, 655302, 656786, 658062, 658565, 659629, 664727, 665160, 666049, 668634, 671424, 672313, 694703, 697917, 697965, 698880, 698977, 699211, 707909, 718546, 719580, 720606, 721493, 723268, 723409, 723493, 724245, 724408, 724594, 724607, 724651, 724746, 724823, 724867, 724899, 724901, 724903, 724904, 724947, 724985, 725014, 725023, 725025, 725027, 725065, 725118, 725148, 725156, 725158, 725159, 725182, 725185, 725295, 725296, 725297, 725456, 725493, 725495, 725498, 725500, 725505, 725506, 725511, 725513, 725518, 725528, 725531, 725535, 725538, 725540, 725544, 725548, 725552, 725559, 725560, 725561, 725562, 725564, 725569, 725573, 725609, 725633, 725655, 725656, 725658, 725659, 725660, 725677, 725678, 725679, 725680, 725681, 725683, 725684, 725689, 725690, 725696, 725709, 725710, 725711, 725712, 725730, 725732, 725734, 725757, 725776, 725786, 725788, 725809, 725840, 725841, 725844, 725845, 725854, 725855, 725872, 725877, 725916, 725924, 725952, 725955, 725961, 725967, 725968, 725969, 725992, 725996, 725997, 726002, 726003, 726004, 726016, 726035, 726037, 726038, 726043, 726055, 726061, 726062, 726063, 726066, 726071, 726073, 726084, 726094, 726095, 726098, 726115, 726118, 726124, 726127, 726169, 726181, 726216, 726361, 726362, 726364, 726365, 727317, 727641, 728170, 728185, 728583, 728706, 729215, 738937, 751849, 755027, 755559, 755774, 756082, 756140, 756263, 757823, 758536, 758553, 762030, 762175, 762186, 762226, 762276, 762376, 762399, 762405, 762420, 762448, 762453, 762523, 762539, 763154, 763169, 763493, 763512, 763861, 764184, 764264, 764305, 764329, 764361, 764944, 765159, 765639, 765715, 765827, 765878, 765881, 765954, 766539, 766957, 767094, 767423, 767485, 767582, 768305, 770057, 770553, 772763, 772935, 775085, 775174, 775655, 775662, 775663, 776587, 776673, 776869, 777895, 779311, 779483, 780396, 782181, 782182, 782640, 784528, 791180, 796824, 798092]
    for id in delate_data:
        medi = session.query(Medicine).filter(Medicine.id == id).first()
        if medi:
            session.delete(medi)
            print('1')
        # session.commit()
if __name__ == '__main__':
    main()
    # delete()